
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>CoreAnimation - tripleCC的技术博客</title>
  <meta name="author" content="tripleCC">

  
  <meta name="description" content="核心动画执行过程都是在后台,不会阻塞主线程
Core Animation是直接作用在CALayer上的，并非UIView。所以Core Animation的一些方法的消息接受者是CALayer，写UIView无法自动补全 CAAnimation 继承结构 所有动画对象的父类， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://triplecc.github.io/blog/2014-01-10-coreanimation/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="tripleCC的技术博客" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://libs.useso.com/js/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.useso.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.useso.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">tripleCC的技术博客</a></h1>
  
    <h2>日拱一卒</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.baidu.com" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="triplecc.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">首页</a></li>
  <li><a href="/blog/archives">所有文章</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">CoreAnimation</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-01-10T08:14:19+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>8:14 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><ul>
<li>核心动画执行过程都是在<code>后台</code>,不会阻塞主线程</li>
<li>Core Animation是直接作用在CALayer上的，并非UIView。所以Core Animation的一些方法的消息接受者是CALayer，写UIView无法自动补全</li>
</ul>


<h2>CAAnimation</h2>

<ul>
<li>继承结构
<img src="/images/Snip20150623_12.png" alt="" />

<ul>
<li>所有动画对象的父类，负责控制动画的持续时间和速度，是个<code>抽象类</code>，不能直接使用，应该使用它具体的子类。</li>
<li>常用属性</li>
</ul>
</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'>  <span class="cm">/** 来自CAMediaTiming协议 */</span>
</span><span class='line'><span class="n">duration</span><span class="err">：动画的持续时间</span>
</span><span class='line'><span class="n">repeatCount</span><span class="err">：动画的重复次数</span>
</span><span class='line'><span class="n">repeatDuration</span><span class="err">：动画的重复时间</span>
</span><span class='line'><span class="n">autoreverses</span><span class="err">：自动返回，做相反的动作</span>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm">1、 kCAFillModeRemoved 这个是默认值,也就是说当动画开始前和动画结束后,动画对layer都没有影响,动画结束后,layer会恢复到之前的状态</span>
</span><span class='line'><span class="cm">2、 kCAFillModeForwards 当动画结束后,layer会一直保持着动画最后的状态</span>
</span><span class='line'><span class="cm">3、 kCAFillModeBackwards 在动画开始前,你只要将动画加入了一个layer,layer便立即进入动画的初始状态并等待动画开始.你可以这样设定测试代码,将一个动画加入一个layer的时候延迟5秒执行.然后就会发现在动画没有开始的时候,只要动画被加入了layer,layer便处于动画初始状态</span>
</span><span class='line'><span class="cm">4、 kCAFillModeBoth 这个其实就是上面两个的合成.动画加入后开始之前,layer便处于动画初始状态,动画结束后layer保持动画最后的状态</span>
</span><span class='line'><span class="cm">*/</span>
</span><span class='line'><span class="n">fillMode</span><span class="err">：决定当前对象在非</span><span class="n">active</span><span class="err">时间段的行为</span><span class="p">.</span><span class="err">比如动画开始之前</span><span class="p">,</span><span class="err">动画结束之后</span>
</span><span class='line'><span class="n">beginTime</span><span class="err">：可以用来设置动画延迟执行时间，若想延迟</span><span class="mi">2</span><span class="n">s</span><span class="err">，就设置为</span><span class="n">CACurrentMediaTime</span><span class="p">()</span><span class="o">+</span><span class="mi">2</span><span class="err">，</span><span class="n">CACurrentMediaTime</span><span class="p">()</span><span class="err">为图层的当前时间</span>
</span><span class='line'>
</span><span class='line'> <span class="cm">/** 自身属性 */</span>
</span><span class='line'> <span class="cm">/**</span>
</span><span class='line'><span class="cm"> CAMediaTimingFunction functionWithName: 加以下常字符串</span>
</span><span class='line'><span class="cm"> 1.kCAMediaTimingFunctionLinear（线性）：匀速，给你一个相对静态的感觉</span>
</span><span class='line'><span class="cm">2.kCAMediaTimingFunctionEaseIn（渐进）：动画缓慢进入，然后加速离开</span>
</span><span class='line'><span class="cm">3.kCAMediaTimingFunctionEaseOut（渐出）：动画全速进入，然后减速的到达目的地</span>
</span><span class='line'><span class="cm">4.kCAMediaTimingFunctionEaseInEaseOut（渐进渐出）：动画缓慢的进入，中间加速，然后减速的到达目的地。这个是默认的动画行为。</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="n">timingFunction</span><span class="err">：速度控制函数，控制动画运行的节奏</span>
</span><span class='line'><span class="n">delegate</span><span class="err">：动画代理</span>
</span><span class='line'><span class="n">removedOnCompletion</span><span class="err">：默认为</span><span class="nb">YES</span><span class="err">，代表动画执行完毕后就从图层上移除，图形会恢复到动画执行前的状态。如果想让图层保持显示动画执行后的状态，那就设置为</span><span class="nb">NO</span><span class="err">，不过还要设置</span><span class="n">fillMode</span><span class="err">为</span><span class="n">kCAFillModeForwards</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>取消动画反弹<br>
<img src="/images/Snip20150623_11.png" alt="" /><br></li>
<li>CALayer上动画的暂停和恢复</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="c1">// t - active local time   图层的本地时间</span>
</span><span class='line'><span class="c1">// tp - parent layer time  父图层的时间</span>
</span><span class='line'><span class="c1">// 父图层和图层本地的时间换算公式</span>
</span><span class='line'><span class="c1">// t = (tp - beginTime) * speed + timeOffset</span>
</span><span class='line'><span class="c1">// beginTime = tp - (t - timeOffset)/speed</span>
</span><span class='line'><span class="cp">#pragma mark 暂停CALayer的动画</span>
</span><span class='line'><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">pauseLayer:</span><span class="p">(</span><span class="bp">CALayer</span><span class="o">*</span><span class="p">)</span><span class="nv">layer</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">CFTimeInterval</span> <span class="n">pausedTime</span> <span class="o">=</span> <span class="p">[</span><span class="n">layer</span> <span class="nl">convertTime</span><span class="p">:</span><span class="n">CACurrentMediaTime</span><span class="p">()</span> <span class="nl">fromLayer</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span><span class='line'>    <span class="n">layer</span><span class="p">.</span><span class="n">speed</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="c1">// 让CALayer的时间停止走动</span>
</span><span class='line'>    <span class="n">layer</span><span class="p">.</span><span class="n">timeOffset</span> <span class="o">=</span> <span class="n">pausedTime</span><span class="p">;</span> <span class="c1">// 让CALayer的时间停留在pausedTime这个时刻</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="cp">#pragma mark 恢复CALayer的动画</span>
</span><span class='line'><span class="p">-(</span><span class="kt">void</span><span class="p">)</span><span class="nf">resumeLayer:</span><span class="p">(</span><span class="bp">CALayer</span><span class="o">*</span><span class="p">)</span><span class="nv">layer</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">CFTimeInterval</span> <span class="n">pausedTime</span> <span class="o">=</span> <span class="n">layer</span><span class="p">.</span><span class="n">timeOffset</span><span class="p">;</span>
</span><span class='line'>    <span class="n">layer</span><span class="p">.</span><span class="n">speed</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="c1">// 让CALayer的时间继续行走</span>
</span><span class='line'>    <span class="n">layer</span><span class="p">.</span><span class="n">timeOffset</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="c1">// 取消上次记录的停留时刻</span>
</span><span class='line'>    <span class="n">layer</span><span class="p">.</span><span class="n">beginTime</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="c1">// 取消上次设置的时间</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 计算暂停的时间(这里用CACurrentMediaTime()-pausedTime也是一样的)</span>
</span><span class='line'>    <span class="n">CFTimeInterval</span> <span class="n">timeSincePause</span> <span class="o">=</span> <span class="p">[</span><span class="n">layer</span> <span class="nl">convertTime</span><span class="p">:</span><span class="n">CACurrentMediaTime</span><span class="p">()</span> <span class="nl">fromLayer</span><span class="p">:</span><span class="nb">nil</span><span class="p">]</span> <span class="o">-</span> <span class="n">pausedTime</span><span class="p">;</span>
</span><span class='line'>    <span class="c1">// 设置相对于父坐标系的开始时间(往后退timeSincePause)</span>
</span><span class='line'>    <span class="n">layer</span><span class="p">.</span><span class="n">beginTime</span> <span class="o">=</span> <span class="n">timeSincePause</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>CAPropertyAnimation</h3>

<ul>
<li>是CAAnimation的子类，也是个抽象类，要想创建动画对象，应该使用它的两个子类：CABasicAnimation和CAKeyframeAnimation</li>
<li>属性</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">keyPath</span><span class="err">：通过指定</span><span class="bp">CALayer</span><span class="err">的一个属性名称为</span><span class="n">keyPath</span><span class="p">(</span><span class="bp">NSString</span><span class="err">类型</span><span class="p">)</span><span class="err">，并且对</span><span class="bp">CALayer</span><span class="err">的这个属性的值进行修改，达到相应的动画效果。比如，指定</span><span class="p">@</span><span class="err">”</span><span class="n">position</span><span class="err">”为</span><span class="n">keyPath</span><span class="err">，就修改</span><span class="bp">CALayer</span><span class="err">的</span><span class="n">position</span><span class="err">属性的值，以达到平移的动画效果</span>
</span></code></pre></td></tr></table></div></figure>


<h4>CABasicAnimation</h4>

<ul>
<li>属性</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">fromValue</span><span class="err">：</span><span class="n">keyPath</span><span class="err">相应属性的初始值</span>
</span><span class='line'><span class="n">toValue</span><span class="err">：</span><span class="n">keyPath</span><span class="err">相应属性的结束值</span>
</span><span class='line'><span class="nl">byValue</span><span class="p">:</span> <span class="err">在当前基础增加属性值</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>随着动画的进行，在长度为duration的持续时间内，keyPath相应属性的值从fromValue渐渐地变为toValue
如果fillMode=kCAFillModeForwards和removedOnComletion=NO，那么在动画执行完毕后，图层会保持显示动画执行后的状态。但在实质上，图层的属性值还是动画执行前的初始值，并没有真正被改变。比如，CALayer的position初始值为(0,0)，CABasicAnimation的fromValue为(10,10)，toValue为(100,100)，虽然动画执行完毕后图层保持在(100,100)这个位置，实质上图层的position还是为(0,0);也就是说<code>核心动画一切都是虚的，都是表象，不会真实地改变图层属性</code>，而UIView动画则不一样，<code>UIView动画需要通过修改属性的真实值才会有动画效果</code></li>
<li>代码示例</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="c1">// 平移动画</span>
</span><span class='line'><span class="bp">CABasicAnimation</span> <span class="o">*</span><span class="n">anim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CABasicAnimation</span> <span class="nl">animationWithKeyPath</span><span class="p">:</span><span class="s">@&quot;position&quot;</span><span class="p">];</span>
</span><span class='line'><span class="n">anim</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// 动画持续1秒</span>
</span><span class='line'><span class="c1">// 因为CGPoint是结构体，所以用NSValue包装成一个OC对象</span>
</span><span class='line'><span class="n">anim</span><span class="p">.</span><span class="n">fromValue</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSValue</span> <span class="nl">valueWithCGPoint</span><span class="p">:</span><span class="n">CGPointMake</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)];</span>
</span><span class='line'><span class="n">anim</span><span class="p">.</span><span class="n">toValue</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSValue</span> <span class="nl">valueWithCGPoint</span><span class="p">:</span><span class="n">CGPointMake</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)];</span>
</span><span class='line'><span class="c1">// 在当前位置的基础上增加多少</span>
</span><span class='line'><span class="c1">// anima.byValue = [NSValue valueWithCGPoint:CGPointMake(0, 300)];</span>
</span><span class='line'><span class="p">[</span><span class="n">layer</span> <span class="nl">addAnimation</span><span class="p">:</span><span class="n">anim</span> <span class="nl">forKey</span><span class="p">:</span><span class="s">@&quot;MyAnim&quot;</span><span class="p">];</span>
</span><span class='line'><span class="c1">// 通过MyAnim可以取回相应的动画对象，比如用来中途取消动画</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 缩放动画</span>
</span><span class='line'><span class="bp">CABasicAnimation</span> <span class="o">*</span><span class="n">anim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CABasicAnimation</span> <span class="nl">animationWithKeyPath</span><span class="p">:</span><span class="s">@&quot;transform&quot;</span><span class="p">];</span>
</span><span class='line'><span class="c1">// 没有设置fromValue说明当前状态作为初始值</span>
</span><span class='line'><span class="c1">// 宽度(width)变为原来的2倍，高度(height)变为原来的1.5倍</span>
</span><span class='line'><span class="n">anim</span><span class="p">.</span><span class="n">toValue</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSValue</span> <span class="nl">valueWithCATransform3D</span><span class="p">:</span><span class="n">CATransform3DMakeScale</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)];</span>
</span><span class='line'><span class="n">anim</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="p">[</span><span class="n">layer</span> <span class="nl">addAnimation</span><span class="p">:</span><span class="n">anim</span> <span class="nl">forKey</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 旋转动画</span>
</span><span class='line'><span class="bp">CABasicAnimation</span> <span class="o">*</span><span class="n">anim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CABasicAnimation</span> <span class="nl">animationWithKeyPath</span><span class="p">:</span><span class="s">@&quot;transform&quot;</span><span class="p">];</span>
</span><span class='line'><span class="c1">// 这里是以向量(1, 1, 0)为轴，旋转π/2弧度(90°)</span>
</span><span class='line'><span class="c1">// 如果只是在手机平面上旋转，就设置向量为(0, 0, 1)，即Z轴</span>
</span><span class='line'><span class="n">anim</span><span class="p">.</span><span class="n">toValue</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSValue</span> <span class="nl">valueWithCATransform3D</span><span class="p">:</span><span class="n">CATransform3DMakeRotation</span><span class="p">(</span><span class="n">M_PI_2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)];</span>
</span><span class='line'><span class="n">anim</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="p">[</span><span class="n">layer</span> <span class="nl">addAnimation</span><span class="p">:</span><span class="n">anim</span> <span class="nl">forKey</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h4>CAKeyframeAnimation</h4>

<ul>
<li>CApropertyAnimation的子类，跟CABasicAnimation的区别是：CABasicAnimation只能从一个数值(fromValue)变到另一个数值(toValue)，而CAKeyframeAnimation会使用一个NSArray保存这些数值;

<ul>
<li>CABasicAnimation可看做是最多只有2个关键帧的CAKeyframeAnimation</li>
</ul>
</li>
<li>属性</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">values</span><span class="err">：就是上述的</span><span class="bp">NSArray</span><span class="err">对象。里面的元素称为”关键帧”</span><span class="p">(</span><span class="n">keyframe</span><span class="p">)</span><span class="err">。动画对象会在指定的时间</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span><span class="err">内，依次显示</span><span class="n">values</span><span class="err">数组中的每一个关键帧</span>
</span><span class='line'><span class="n">path</span><span class="err">：可以设置一个</span><span class="n">CGPathRef</span><span class="err">\</span><span class="n">CGMutablePathRef</span><span class="p">,</span><span class="err">让层跟着路径移动。</span><span class="n">path</span><span class="err">只对</span><span class="bp">CALayer</span><span class="err">的</span><span class="n">anchorPoint</span><span class="err">和</span><span class="n">position</span><span class="err">起作用。如果你设置了</span><span class="n">path</span><span class="err">，那么</span><span class="n">values</span><span class="err">将被忽略</span>
</span><span class='line'><span class="c1">// 如有5个关键帧，则值可为@[@(0.1), @(0.4), @(0.5), @(0.7), @(1.0)]。注意，这其中的元素是时间点，而不是时间段，所以后面的要大于前面的值。</span>
</span><span class='line'><span class="n">keyTimes</span><span class="err">：可以为对应的关键帧指定对应的时间点</span><span class="p">,</span><span class="err">其取值范围为</span><span class="mi">0</span><span class="err">到</span><span class="mf">1.0</span><span class="p">,</span><span class="n">keyTimes</span><span class="err">中的每一个时间值都对应</span><span class="n">values</span><span class="err">中的每一帧</span><span class="p">.</span><span class="err">当</span><span class="n">keyTimes</span><span class="err">没有设置的时候</span><span class="p">,</span><span class="err">各个关键帧的时间是平分的。</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm">kCAAnimationLinear calculationMode的默认值,表示当关键帧为座标点的时候,关键帧之间直接直线相连进行插值计算;</span>
</span><span class='line'><span class="cm">kCAAnimationDiscrete 离散的,就是不进行插值计算,所有关键帧直接逐个进行显示;</span>
</span><span class='line'><span class="cm">kCAAnimationPaced 使得动画均匀进行,而不是按keyTimes设置的或者按关键帧平分时间,此时keyTimes和timingFunctions无效;</span>
</span><span class='line'><span class="cm">kCAAnimationCubic 对关键帧为座标点的关键帧进行圆滑曲线相连后插值计算，这里的主要目的是使得运行的轨迹变得圆滑；</span>
</span><span class='line'><span class="cm">kCAAnimationCubicPaced 看这个名字就知道和kCAAnimationCubic有一定联系,其实就是在kCAAnimationCubic的基础上使得动画运行变得均匀,就是系统时间内运动的距离相同,此时keyTimes以及timingFunctions也是无效的</span>
</span><span class='line'><span class="cm">*/</span>
</span><span class='line'><span class="c1">// 针对的是每一帧的内容为一个座标点的情况,也就是对anchorPoint 和 position 进行的动画.当在平面座标系中有多个离散的点的时候,可以是离散的,也可以直线相连后进行插值计算,也可以使用圆滑的曲线将他们相连后进行插值计算</span>
</span><span class='line'><span class="n">calculationMode</span><span class="err">：</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>图标抖动</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'>  <span class="c1">// 1.创建核心动画</span>
</span><span class='line'>    <span class="bp">CAKeyframeAnimation</span>  <span class="o">*</span><span class="n">keyAnima</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CAKeyframeAnimation</span> <span class="n">animation</span><span class="p">];</span>
</span><span class='line'>    <span class="n">keyAnima</span><span class="p">.</span><span class="n">keyPath</span> <span class="o">=</span> <span class="s">@&quot;transform.rotation&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="c1">// 度数 / 180 * M_PI</span>
</span><span class='line'>    <span class="n">keyAnima</span><span class="p">.</span><span class="n">values</span> <span class="o">=</span> <span class="l">@[@(</span><span class="o">-</span><span class="n">M_PI_4</span> <span class="o">*</span> <span class="mf">0.1</span><span class="l">)</span><span class="p">,</span> <span class="l">@(</span><span class="n">M_PI_4</span> <span class="o">*</span> <span class="mf">0.1</span><span class="l">)</span><span class="p">,</span> <span class="l">@(</span><span class="o">-</span><span class="n">M_PI_4</span> <span class="o">*</span> <span class="mf">0.1</span><span class="l">)]</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">keyAnima</span><span class="p">.</span><span class="n">removedOnCompletion</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span>
</span><span class='line'>    <span class="n">keyAnima</span><span class="p">.</span><span class="n">fillMode</span> <span class="o">=</span> <span class="n">kCAFillModeForwards</span><span class="p">;</span>
</span><span class='line'>    <span class="n">keyAnima</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 设置动画重复的次数</span>
</span><span class='line'>    <span class="n">keyAnima</span><span class="p">.</span><span class="n">repeatCount</span> <span class="o">=</span> <span class="n">MAXFLOAT</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// 2.添加核心动画</span>
</span><span class='line'>    <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">iconView</span><span class="p">.</span><span class="n">layer</span> <span class="nl">addAnimation</span><span class="p">:</span><span class="n">keyAnima</span> <span class="nl">forKey</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h4>CAAnimationGroup</h4>

<ul>
<li>CAAnimation的子类，可以保存一组动画对象，将CAAnimationGroup对象加入层后，组中所有动画对象可以同时并发运行

<ul>
<li>默认情况下，一组动画对象是同时运行的，也可以通过<code>设置动画对象的beginTime属性</code>来<code>更改动画的开始时间</code></li>
</ul>
</li>
<li>属性</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">animations</span><span class="err">：用来保存一组动画对象的</span><span class="bp">NSArray</span>
</span></code></pre></td></tr></table></div></figure>


<h4>CATransition</h4>

<ul>
<li>CAAnimation的子类，用于做转场动画，能够为层提供移出屏幕和移入屏幕的动画效果。iOS比Mac OS X的转场动画效果少一点</li>
<li>UINavigationController就是通过CATransition实现了将控制器的视图推入屏幕的动画效果</li>
<li>属性</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="cm">/* 过渡效果</span>
</span><span class='line'><span class="cm"> fade     //交叉淡化过渡(不支持过渡方向) kCATransitionFade</span>
</span><span class='line'><span class="cm"> push     //新视图把旧视图推出去  kCATransitionPush</span>
</span><span class='line'><span class="cm"> moveIn   //新视图移到旧视图上面   kCATransitionMoveIn</span>
</span><span class='line'><span class="cm"> reveal   //将旧视图移开,显示下面的新视图  kCATransitionReveal</span>
</span><span class='line'><span class="cm"> cube     //立方体翻滚效果</span>
</span><span class='line'><span class="cm"> oglFlip  //上下左右翻转效果</span>
</span><span class='line'><span class="cm"> suckEffect   //收缩效果，如一块布被抽走(不支持过渡方向)</span>
</span><span class='line'><span class="cm"> rippleEffect //滴水效果(不支持过渡方向)</span>
</span><span class='line'><span class="cm"> pageCurl     //向上翻页效果</span>
</span><span class='line'><span class="cm"> pageUnCurl   //向下翻页效果</span>
</span><span class='line'><span class="cm"> cameraIrisHollowOpen  //相机镜头打开效果(不支持过渡方向)</span>
</span><span class='line'><span class="cm"> cameraIrisHollowClose //相机镜头关上效果(不支持过渡方向)</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="n">type</span><span class="err">：动画过渡类型</span>
</span><span class='line'><span class="cm">/* 过渡方向</span>
</span><span class='line'><span class="cm">kCATransitionFromRight</span>
</span><span class='line'><span class="cm">kCATransitionFromLeft</span>
</span><span class='line'><span class="cm">kCATransitionFromBottom</span>
</span><span class='line'><span class="cm">kCATransitionFromTop</span>
</span><span class='line'><span class="cm">*/</span>
</span><span class='line'><span class="n">subtype</span><span class="err">：动画过渡方向</span>
</span><span class='line'><span class="n">startProgress</span><span class="err">：动画起点</span><span class="p">(</span><span class="err">在整体动画的百分比</span><span class="p">)</span>
</span><span class='line'><span class="n">endProgress</span><span class="err">：动画终点</span><span class="p">(</span><span class="err">在整体动画的百分比</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>代码示例

<ul>
<li>转场一般分为转场代码和转场动画</li>
<li>转场代码和转场动画一定要写在一起</li>
</ul>
</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="bp">CATransition</span> <span class="o">*</span><span class="n">anim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">CATransition</span> <span class="n">animation</span><span class="p">];</span>
</span><span class='line'><span class="n">anim</span><span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="p">@</span><span class="err">“</span><span class="n">cube</span><span class="err">”</span><span class="p">;</span> <span class="c1">// 动画过渡类型</span>
</span><span class='line'><span class="n">anim</span><span class="p">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="n">kCATransitionFromTop</span><span class="p">;</span> <span class="c1">// 动画过渡方向</span>
</span><span class='line'><span class="n">anim</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// 动画持续1s</span>
</span><span class='line'><span class="c1">// 代理，动画执行完毕后会调用delegate的animationDidStop:finished:</span>
</span><span class='line'><span class="c1">// anim.delegate = self;</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/*******中间穿插改变layer属性的代码**********/</span>
</span><span class='line'>
</span><span class='line'><span class="p">[</span><span class="n">layer</span> <span class="nl">addAnimation</span><span class="p">:</span><span class="n">anim</span> <span class="nl">forKey</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h3>UIView动画</h3>

<ul>
<li>UIKit直接将动画集成到UIView类中，当内部的一些属性发生改变时，UIView将为这些改变提供动画支持
执行动画所需要的工作由UIView类自动完成，但仍要在希望执行动画时通知视图，为此需要将改变属性的代码放在<code>[UIView beginAnimations:nil context:nil]和[UIView commitAnimations]</code>之间</li>
<li>常见方法</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setAnimationDelegate:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">delegate</span>
</span><span class='line'><span class="c1">// 设置动画代理对象，当动画开始或者结束时会发消息给代理对象</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setAnimationWillStartSelector:</span><span class="p">(</span><span class="kt">SEL</span><span class="p">)</span><span class="nv">selector</span>
</span><span class='line'><span class="c1">// 当动画即将开始时，执行delegate对象的selector，并且把beginAnimations:context:中传入的参数传进selector</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setAnimationDidStopSelector:</span><span class="p">(</span><span class="kt">SEL</span><span class="p">)</span><span class="nv">selector</span>
</span><span class='line'><span class="c1">// 当动画结束时，执行delegate对象的selector，并且把beginAnimations:context:中传入的参数传进selector</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setAnimationDuration:</span><span class="p">(</span><span class="n">NSTimeInterval</span><span class="p">)</span><span class="nv">duration</span>
</span><span class='line'><span class="c1">// 动画的持续时间，秒为单位</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setAnimationDelay:</span><span class="p">(</span><span class="n">NSTimeInterval</span><span class="p">)</span><span class="nv">delay</span>
</span><span class='line'><span class="c1">// 动画延迟delay秒后再开始</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setAnimationStartDate:</span><span class="p">(</span><span class="bp">NSDate</span> <span class="o">*</span><span class="p">)</span><span class="nv">startDate</span>
</span><span class='line'><span class="c1">// 动画的开始时间，默认为now</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 动画的节奏控制，跟CAAnimation的timingFunction属性类似</span>
</span><span class='line'><span class="k">typedef</span> <span class="nf">NS_ENUM</span><span class="p">(</span><span class="bp">NSInteger</span><span class="p">,</span> <span class="n">UIViewAnimationCurve</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">UIViewAnimationCurveEaseInOut</span><span class="p">,</span>         <span class="c1">// slow at beginning and end</span>
</span><span class='line'>    <span class="n">UIViewAnimationCurveEaseIn</span><span class="p">,</span>            <span class="c1">// slow at beginning</span>
</span><span class='line'>    <span class="n">UIViewAnimationCurveEaseOut</span><span class="p">,</span>           <span class="c1">// slow at end</span>
</span><span class='line'>    <span class="n">UIViewAnimationCurveLinear</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setAnimationCurve:</span><span class="p">(</span><span class="n">UIViewAnimationCurve</span><span class="p">)</span><span class="nv">curve</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// 动画的节奏控制,具体看下面的”备注”</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setAnimationRepeatCount:</span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="nv">repeatCount</span>
</span><span class='line'><span class="c1">// 动画的重复次数</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setAnimationRepeatAutoreverses:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">repeatAutoreverses</span>
</span><span class='line'><span class="c1">// 如果设置为YES,代表动画每次重复执行的效果会跟上一次相反</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setAnimationTransition:</span><span class="p">(</span><span class="n">UIViewAnimationTransition</span><span class="p">)</span><span class="nv">transition</span> <span class="nf">forView:</span><span class="p">(</span><span class="bp">UIView</span> <span class="o">*</span><span class="p">)</span><span class="nv">view</span> <span class="nf">cache:</span><span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nv">cache</span>
</span><span class='line'><span class="c1">// 设置视图view的过渡效果, transition指定过渡类型, cache设置YES代表使用视图缓存，性能较好</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Block动画</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm">duration：动画的持续时间</span>
</span><span class='line'><span class="cm">delay：动画延迟delay秒后开始</span>
</span><span class='line'>
</span><span class='line'><span class="cm">// 动画的节奏控制枚举常量</span>
</span><span class='line'><span class="cm">// UIViewAnimationOptionCurveEaseInOut</span>
</span><span class='line'><span class="cm">// UIViewAnimationOptionCurveEaseIn</span>
</span><span class='line'><span class="cm">// UIViewAnimationOptionCurveEaseOut</span>
</span><span class='line'><span class="cm">// UIViewAnimationOptionCurveLinear</span>
</span><span class='line'><span class="cm">options：动画的节奏控制</span>
</span><span class='line'>
</span><span class='line'><span class="cm">animations：将改变视图属性的代码放在这个block中</span>
</span><span class='line'><span class="cm">completion：动画结束后，会自动调用这个block</span>
</span><span class='line'><span class="cm">*/</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">animateWithDuration:</span><span class="p">(</span><span class="n">NSTimeInterval</span><span class="p">)</span><span class="nv">duration</span> <span class="nf">delay:</span><span class="p">(</span><span class="n">NSTimeInterval</span><span class="p">)</span><span class="nv">delay</span> <span class="nf">options:</span><span class="p">(</span><span class="n">UIViewAnimationOptions</span><span class="p">)</span><span class="nv">options</span> <span class="nf">animations:</span><span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="p">)(</span><span class="kt">void</span><span class="p">))</span><span class="nv">animations</span> <span class="nf">completion:</span><span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="p">)(</span><span class="kt">BOOL</span> <span class="n">finished</span><span class="p">))</span><span class="nv">completion</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm">duration：动画的持续时间</span>
</span><span class='line'><span class="cm">view：需要进行转场动画的视图</span>
</span><span class='line'>
</span><span class='line'><span class="cm">// 转场动画的类型</span>
</span><span class='line'><span class="cm">//UIViewAnimationOptionTransitionNone</span>
</span><span class='line'><span class="cm">//UIViewAnimationOptionTransitionFlipFromLeft</span>
</span><span class='line'><span class="cm">//UIViewAnimationOptionTransitionFlipFromRight</span>
</span><span class='line'><span class="cm">//UIViewAnimationOptionTransitionCurlUp</span>
</span><span class='line'><span class="cm">//UIViewAnimationOptionTransitionCurlDown</span>
</span><span class='line'><span class="cm">//UIViewAnimationOptionTransitionCrossDissolve</span>
</span><span class='line'><span class="cm">//UIViewAnimationOptionTransitionFlipFromTop</span>
</span><span class='line'><span class="cm">//UIViewAnimationOptionTransitionFlipFromBottom</span>
</span><span class='line'><span class="cm">options：转场动画的类型</span>
</span><span class='line'>
</span><span class='line'><span class="cm">animations：将改变视图属性的代码放在这个block中</span>
</span><span class='line'><span class="cm">completion：动画结束后，会自动调用这个block</span>
</span><span class='line'><span class="cm">*/</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">transitionWithView:</span><span class="p">(</span><span class="bp">UIView</span> <span class="o">*</span><span class="p">)</span><span class="nv">view</span> <span class="nf">duration:</span><span class="p">(</span><span class="n">NSTimeInterval</span><span class="p">)</span><span class="nv">duration</span> <span class="nf">options:</span><span class="p">(</span><span class="n">UIViewAnimationOptions</span><span class="p">)</span><span class="nv">options</span> <span class="nf">animations:</span><span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="p">)(</span><span class="kt">void</span><span class="p">))</span><span class="nv">animations</span> <span class="nf">completion:</span><span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="p">)(</span><span class="kt">BOOL</span> <span class="n">finished</span><span class="p">))</span><span class="nv">completion</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm">duration：动画的持续时间</span>
</span><span class='line'><span class="cm">options：转场动画的类型</span>
</span><span class='line'><span class="cm">animations：将改变视图属性的代码放在这个block中</span>
</span><span class='line'><span class="cm">completion：动画结束后，会自动调用这个block</span>
</span><span class='line'><span class="cm">*/</span>
</span><span class='line'> <span class="o">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">transitionFromView</span><span class="p">:(</span><span class="bp">UIView</span> <span class="o">*</span><span class="p">)</span><span class="n">fromView</span> <span class="nl">toView</span><span class="p">:(</span><span class="bp">UIView</span> <span class="o">*</span><span class="p">)</span><span class="n">toView</span> <span class="nl">duration</span><span class="p">:(</span><span class="n">NSTimeInterval</span><span class="p">)</span><span class="n">duration</span> <span class="nl">options</span><span class="p">:(</span><span class="n">UIViewAnimationOptions</span><span class="p">)</span><span class="n">options</span> <span class="nl">completion</span><span class="p">:(</span><span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="p">)(</span><span class="kt">BOOL</span> <span class="n">finished</span><span class="p">))</span><span class="n">completion</span>
</span><span class='line'>
</span><span class='line'> <span class="c1">// 以上方法调用相当于以下两句</span>
</span><span class='line'> <span class="c1">// 添加toView到父视图</span>
</span><span class='line'><span class="p">[</span><span class="n">fromView</span><span class="p">.</span><span class="n">superview</span> <span class="nl">addSubview</span><span class="p">:</span><span class="n">toView</span><span class="p">];</span>
</span><span class='line'><span class="c1">// 把fromView从父视图中移除</span>
</span><span class='line'><span class="p">[</span><span class="n">fromView</span><span class="p">.</span><span class="n">superview</span> <span class="n">removeFromSuperview</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<h3>UIImageView的帧动画</h3>

<ul>
<li>UIImageView可以让一系列的图片在特定的时间内按顺序显示</li>
<li>属性</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">animationImages</span><span class="err">：要显示的图片</span><span class="p">(</span><span class="err">一个装着</span><span class="bp">UIImage</span><span class="err">的</span><span class="bp">NSArray</span><span class="p">)</span>
</span><span class='line'><span class="n">animationDuration</span><span class="err">：完整地显示一次</span><span class="n">animationImages</span><span class="err">中的所有图片所需的时间</span>
</span><span class='line'><span class="n">animationRepeatCount</span><span class="err">：动画的执行次数</span><span class="p">(</span><span class="err">默认为</span><span class="mi">0</span><span class="err">，代表无限循环</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>方法</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">startAnimating</span><span class="p">;</span> <span class="err">开始动画</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">stopAnimating</span><span class="p">;</span>  <span class="err">停止动画</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="n">isAnimating</span><span class="p">;</span>  <span class="err">是否正在运行动画</span>
</span></code></pre></td></tr></table></div></figure>


<h3>UIActivityIndicatorView动画</h3>

<ul>
<li>是一个旋转进度轮，可以用来告知用户有一个操作正在进行中，一般用initWithActivityIndicatorStyle初始化</li>
<li>方法</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">startAnimating</span><span class="p">;</span> <span class="err">开始动画</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">stopAnimating</span><span class="p">;</span>  <span class="err">停止动画</span>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="n">isAnimating</span><span class="p">;</span>  <span class="err">是否正在运行动画</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>UIActivityIndicatorViewStyle有3个值可供选择：</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">UIActivityIndicatorViewStyleWhiteLarge</span>   <span class="c1">//大型白色指示器</span>
</span><span class='line'><span class="n">UIActivityIndicatorViewStyleWhite</span>      <span class="c1">//标准尺寸白色指示器</span>
</span><span class='line'><span class="n">UIActivityIndicatorViewStyleGray</span>    <span class="c1">//灰色指示器，用于白色背景</span>
</span></code></pre></td></tr></table></div></figure>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">tripleCC</span></span>

      




<time class='entry-date' datetime='2014-01-10T08:14:19+08:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>8:14 am</span></time>
      


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014-01-01-calayer/" title="Previous Post: CALayer">&laquo; CALayer</a>
      
      
        <a class="basic-alignment right" href="/blog/2014-02-02-ji-ge-layoutfang-fa-zhi-jian-de-guan-xi/" title="Next Post: 几个layout方法之间的关系">几个layout方法之间的关系 &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p> 喜欢技术，热衷底层，涉略微处理器、linux，最终加入移动大家庭 </p>
</section>

<section>
    <h1>文章分类</h1>
    <ul id="categories">
        
    </ul>
</section><section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015-09-02-shi-yong-xiang-ying-zhe-lian-tiao-jie-jue-xu-qiu/">使用响应者链条解决需求</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-06-03-cheng-xu-bu-si/">程序不死</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-05-31-runloopzhi-shi-shu-li/">Runloop知识梳理</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-04-27-uinavigationbarshu-xing-xiao-jie-ji-fan-hui-an-niu-geng-gai/">UINavigationBar属性小结及返回按钮更改</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-04-10-runtimeying-yong-zhi-guan-lian-dui-xiang-he-methodswizzling/">Runtime应用之关联对象和MethodSwizzling</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-03-02-jing-tai-fen-xi-bu-zhun-que-de-qing-kuang/">静态分析不准确的情况</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-02-10-blockji-qiao-yu-di-ceng-jie-xi/">Block技巧与底层解析</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-02-01-sdwebimagejia-zai-da-tu/">SDWebImage加载大图崩溃</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-01-27-uitextfiledwen-zi-dou-dong-xiao-guo/">UITextFiled文字抖动效果</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-01-22-chang-yong-runtimehan-shu/">常用Runtime函数</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-01-21-runtimeying-yong-zhi-kvc/">Runtime应用之KVC</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-01-10-runtimeji-chu/">Runtime基础</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-01-02-jian-ting-jian-pan-shan-chu-an-niu/">监听键盘删除按钮</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-12-04-autorezingde-ying-yong/">Preview功能结合Autorezing的应用</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-11-02-she-zhi-cellzhou-bian-jian-ju/">设置cell周边间距</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-10-20-uialertcontrollerde-shi-yong/">UIAlertController的使用</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-10-05-shuang-ji-di-bu-gong-ju-lan-itemdui-ying-uitableviewzhong-xin-shua-xin/">双击底部工具栏Item对应UITableView重新刷新</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-09-11-zi-ding-yi-uitextview/">自定义UITextView</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-09-01-zi-ding-yi-ti-shi-hong/">自定义提示宏</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-08-29-tableviewyou-ce-biao-qian-suo-yin-xu-qiu/">UITableView右侧标签索引需求</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - tripleCC -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
